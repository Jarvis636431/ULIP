Not using distributed mode
=> creating model: ULIP2_PointBERT_Colored
Get openclip model:
Finished loading the openclip model.
2024-08-21 15:51:49,591 - ModelNet - INFO - The size of train data is 9843
2024-08-21 15:51:49,591 - ModelNet - INFO - Load processed data from data/modelnet40_normal_resampled/modelnet40_train_8192pts_fps.dat...
2024-08-21 15:51:51,252 - ModelNet - INFO - The size of test data is 2468
2024-08-21 15:51:51,252 - ModelNet - INFO - Load processed data from data/modelnet40_normal_resampled/modelnet40_test_8192pts_fps.dat...
training from scratch for pointbert.
model size:
32.50M
=> creating dataset
(2468,)
(2468,)
9843
2468
Namespace(batch_size=64, betas=(0.9, 0.98), disable_amp=False, dist_backend='nccl', dist_url='env://', distributed=False, epochs=250, eps=1e-08, eval_freq=1, evaluate_3d=False, evaluate_3d_ulip2=False, gpu=None, local_rank=0, lr=0.003, lr_end=1e-05, lr_start=1e-06, model='ULIP2_PointBERT_Colored', npoints=10000, output_dir='./outputs/train_pointbert_8kpts', pretrain_dataset_name='modelnet40', pretrain_dataset_prompt='shapenet_64', print_freq=10, rank=0, resume='', seed=0, start_epoch=0, test_ckpt_addr='', update_freq=1, use_height=False, validate_dataset_name='modelnet40', validate_dataset_prompt='modelnet40_64', wandb=False, warmup_epochs=1, wd=0.1, workers=10, world_size=1)
=> beginning training
153
Traceback (most recent call last):
  File "main.py", line 585, in <module>
    main(args)
  File "main.py", line 224, in main
    train_stats = train(train_loader, model, criterion, optimizer, scaler, epoch, lr_schedule, args)
  File "main.py", line 292, in train
    for data_iter, inputs in enumerate(train_loader):
  File "/home/server/miniconda3/envs/ulip/lib/python3.7/site-packages/torch/utils/data/dataloader.py", line 521, in __next__
    data = self._next_data()
  File "/home/server/miniconda3/envs/ulip/lib/python3.7/site-packages/torch/utils/data/dataloader.py", line 1203, in _next_data
    return self._process_data(data)
  File "/home/server/miniconda3/envs/ulip/lib/python3.7/site-packages/torch/utils/data/dataloader.py", line 1229, in _process_data
    data.reraise()
  File "/home/server/miniconda3/envs/ulip/lib/python3.7/site-packages/torch/_utils.py", line 434, in reraise
    raise exception
IndexError: Caught IndexError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/home/server/miniconda3/envs/ulip/lib/python3.7/site-packages/torch/utils/data/_utils/worker.py", line 287, in _worker_loop
    data = fetcher.fetch(index)
  File "/home/server/miniconda3/envs/ulip/lib/python3.7/site-packages/torch/utils/data/_utils/fetch.py", line 49, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/server/miniconda3/envs/ulip/lib/python3.7/site-packages/torch/utils/data/_utils/fetch.py", line 49, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/server/tju/pointcloud/ULIP/data/dataset_3d.py", line 303, in __getitem__
    points, label = self._get_item(index)
  File "/home/server/tju/pointcloud/ULIP/data/dataset_3d.py", line 291, in _get_item
    point_set = self.modelnet_10k_rgb_data[index]['xyz']
IndexError: index 8920 is out of bounds for axis 0 with size 2468

